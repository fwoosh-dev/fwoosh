import{r as $,R as u}from"./jsx-runtime-45b8ed70.js";import{p as w,i as G,T as J,I as K}from"./index-2769b282.js";import{w as Q}from"./useParams-21d99adc.js";import"./index-49f43349.js";function T(){return T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},T.apply(this,arguments)}function U(e,t){if(e==null)return{};var o=tt(e,t),n,i;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function tt(e,t){if(e==null)return{};var o={},n=Object.keys(e),i,r;for(r=0;r<n.length;r++)i=n[r],!(t.indexOf(i)>=0)&&(o[i]=e[i]);return o}var C=$.forwardRef(function(e,t){var o=e.color,n=o===void 0?"currentColor":o,i=e.size,r=i===void 0?24:i,l=U(e,["color","size"]);return u.createElement("svg",T({ref:t,xmlns:"http://www.w3.org/2000/svg",width:r,height:r,viewBox:"0 0 24 24",fill:"none",stroke:n,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},l),u.createElement("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),u.createElement("line",{x1:"8",y1:"12",x2:"16",y2:"12"}),u.createElement("line",{x1:"12",y1:"16",x2:"12",y2:"16"}),u.createElement("line",{x1:"12",y1:"8",x2:"12",y2:"8"}))});C.propTypes={color:w.string,size:w.oneOfType([w.string,w.number])};C.displayName="DivideSquare";const et=C;function j(){return j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},j.apply(this,arguments)}function ot(e,t){if(e==null)return{};var o=nt(e,t),n,i;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function nt(e,t){if(e==null)return{};var o={},n=Object.keys(e),i,r;for(r=0;r<n.length;r++)i=n[r],!(t.indexOf(i)>=0)&&(o[i]=e[i]);return o}var L=$.forwardRef(function(e,t){var o=e.color,n=o===void 0?"currentColor":o,i=e.size,r=i===void 0?24:i,l=ot(e,["color","size"]);return u.createElement("svg",j({ref:t,xmlns:"http://www.w3.org/2000/svg",width:r,height:r,viewBox:"0 0 24 24",fill:"none",stroke:n,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},l),u.createElement("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),u.createElement("line",{x1:"9",y1:"9",x2:"15",y2:"15"}),u.createElement("line",{x1:"15",y1:"9",x2:"9",y2:"15"}))});L.propTypes={color:w.string,size:w.oneOfType([w.string,w.number])};L.displayName="XSquare";const it=L;function z(e){const t=Math.max(e.scrollHeight,e.offsetHeight);return{width:Math.max(e.scrollWidth,e.offsetWidth),height:t}}function rt(e){const t=document.createElement("canvas");t.id="fwoosh-addon-measure";const o=t.getContext("2d");if(!o)throw new Error("Canvas is not supported in this browser");const n=document.getElementById(e);if(!n)throw new Error("Can't find element with id "+e);const{width:i,height:r}=z(n);return B(t,o,{width:i,height:r}),t.style.position="absolute",t.style.left="0",t.style.top="0",t.style.zIndex="2147483647",t.style.pointerEvents="none",n.appendChild(t),{canvas:t,context:o,width:i,height:r}}function B(e,t,{width:o,height:n}){e.style.width=`${o}px`,e.style.height=`${n}px`;const i=window.devicePixelRatio;e.width=Math.floor(o*i),e.height=Math.floor(n*i),t.scale(i,i)}let c={};function lt(e){c.canvas||(c=rt(e))}function W(){c.context&&typeof c.width<"u"&&typeof c.height<"u"&&c.context.clearRect(0,0,c.width,c.height)}function st(e){W(),c.context&&e(c.context)}function ft(e){if(!c.canvas||!c.context)throw new Error("Canvas is not initialized");B(c.canvas,c.context,{width:0,height:0});const t=document.getElementById(e);if(!t)throw new Error("Can't find element with id "+e);const{width:o,height:n}=z(t);B(c.canvas,c.context,{width:o,height:n}),c.width=o,c.height=n}function at(){c.canvas&&c.canvas.parentNode&&(W(),c.canvas.parentNode.removeChild(c.canvas),c={})}const y={margin:"#f6b26b",border:"#ffe599",padding:"#93c47d",content:"#6fa8dc",text:"#232020"},d=6;function M(e,{x:t,y:o,w:n,h:i,r}){t=t-n/2,o=o-i/2,n<2*r&&(r=n/2),i<2*r&&(r=i/2),e.beginPath(),e.moveTo(t+r,o),e.arcTo(t+n,o,t+n,o+i,r),e.arcTo(t+n,o+i,t,o+i,r),e.arcTo(t,o+i,t,o,r),e.arcTo(t,o,t+n,o,r),e.closePath()}function ct(e,{padding:t,border:o,width:n,height:i,top:r,left:l}){const s=n-o.left-o.right-t.left-t.right,f=i-t.top-t.bottom-o.top-o.bottom;let a=l+o.left+t.left,h=r+o.top+t.top;return e==="top"?a+=s/2:e==="right"?(a+=s,h+=f/2):e==="bottom"?(a+=s/2,h+=f):e==="left"?h+=f/2:e==="center"&&(a+=s/2,h+=f/2),{x:a,y:h}}function ht(e,t,{margin:o,border:n,padding:i},r,l){let s=p=>0,f=0,a=0;const h=l?1:.5,m=l?r*2:0;return e==="padding"?s=p=>i[p]*h+m:e==="border"?s=p=>i[p]+n[p]*h+m:e==="margin"&&(s=p=>i[p]+n[p]+o[p]*h+m),t==="top"?a=-s("top"):t==="right"?f=s("right"):t==="bottom"?a=s("bottom"):t==="left"&&(f=-s("left")),{offsetX:f,offsetY:a}}function ut(e,t){return Math.abs(e.x-t.x)<Math.abs(e.w+t.w)/2&&Math.abs(e.y-t.y)<Math.abs(e.h+t.h)/2}function pt(e,t,o){return e==="top"?t.y=o.y-o.h-d:e==="right"?t.x=o.x+o.w/2+d+t.w/2:e==="bottom"?t.y=o.y+o.h+d:e==="left"&&(t.x=o.x-o.w/2-d-t.w/2),{x:t.x,y:t.y}}function R(e,t,{x:o,y:n,w:i,h:r},l){return M(e,{x:o,y:n,w:i,h:r,r:3}),e.fillStyle=`${y[t]}dd`,e.fill(),e.strokeStyle=y[t],e.stroke(),e.fillStyle=y.text,e.fillText(l,o,n),M(e,{x:o,y:n,w:i,h:r,r:3}),e.fillStyle=`${y[t]}dd`,e.fill(),e.strokeStyle=y[t],e.stroke(),e.fillStyle=y.text,e.fillText(l,o,n),{x:o,y:n,w:i,h:r}}function A(e,t){e.font="600 12px monospace",e.textBaseline="middle",e.textAlign="center";const o=e.measureText(t),n=o.actualBoundingBoxAscent+o.actualBoundingBoxDescent,i=o.width+d*2,r=n+d*2;return{w:i,h:r}}function mt(e,t,{type:o,position:n="center",text:i},r,l=!1){let{x:s,y:f}=ct(n,t);const{offsetX:a,offsetY:h}=ht(o,n,t,d+1,l);s+=a,f+=h;const{w:m,h:p}=A(e,i);if(r&&ut({x:s,y:f,w:m,h:p},r)){const O=pt(n,{x:s,y:f,w:m,h:p},r);s=O.x,f=O.y}return R(e,o,{x:s,y:f,w:m,h:p},i)}function gt(e,{w:t,h:o}){const n=t*.5+d,i=o*.5+d;return{offsetX:(e.x==="left"?-1:1)*n,offsetY:(e.y==="top"?-1:1)*i}}function dt(e,t,{type:o,text:n}){const{floatingAlignment:i,extremities:r}=t;let l=r[i.x],s=r[i.y];const{w:f,h:a}=A(e,n),{offsetX:h,offsetY:m}=gt(i,{w:f,h:a});return l+=h,s+=m,R(e,o,{x:l,y:s,w:f,h:a},n)}function v(e,t,o,n){const i=[];o.forEach((r,l)=>{const s=n&&r.position==="center"?dt(e,t,r):mt(e,t,r,i[l-1],n);i[l]=s})}function wt(e,t,o,n){const i=o.reduce((r,l)=>{var s;return Object.prototype.hasOwnProperty.call(r,l.position)||(r[l.position]=[]),(s=r[l.position])===null||s===void 0||s.push(l),r},{});i.top&&v(e,t,i.top,n),i.right&&v(e,t,i.right,n),i.bottom&&v(e,t,i.bottom,n),i.left&&v(e,t,i.left,n),i.center&&v(e,t,i.center,n)}const S={margin:"#f6b26ba8",border:"#ffe599a8",padding:"#93c47d8c",content:"#6fa8dca8"},P=30;function g(e){return parseInt(e.replace("px",""),10)}function b(e){return Number.isInteger(e)?e:e.toFixed(2)}function k(e){return e.filter(t=>t.text!==0&&t.text!=="0")}function yt(e){const t={top:window.scrollY,bottom:window.scrollY+window.innerHeight,left:window.scrollX,right:window.scrollX+window.innerWidth},o={top:Math.abs(t.top-e.top),bottom:Math.abs(t.bottom-e.bottom),left:Math.abs(t.left-e.left),right:Math.abs(t.right-e.right)};return{x:o.left>o.right?"left":"right",y:o.top>o.bottom?"top":"bottom"}}function bt(e,t){const o=document.getElementById(t);if(!o)throw new Error(`Could not find container with id ${t}`);const n=o.getBoundingClientRect(),i=getComputedStyle(e);let{top:r,left:l,right:s,bottom:f,width:a,height:h}=e.getBoundingClientRect();const{marginTop:m,marginBottom:p,marginLeft:O,marginRight:H,paddingTop:X,paddingBottom:q,paddingLeft:I,paddingRight:Y,borderBottomWidth:_,borderTopWidth:N,borderLeftWidth:D,borderRightWidth:F}=i;r=r+window.scrollY-n.top,l=l+window.scrollX-n.left,f=f+window.scrollY-n.top,s=s+window.scrollX-n.left;const E={top:g(m),bottom:g(p),left:g(O),right:g(H)},Z={top:g(X),bottom:g(q),left:g(I),right:g(Y)},V={top:g(N),bottom:g(_),left:g(D),right:g(F)},x={top:r-E.top,bottom:f+E.bottom,left:l-E.left,right:s+E.right};return{margin:E,padding:Z,border:V,top:r,left:l,bottom:f,right:s,width:a,height:h,extremities:x,floatingAlignment:yt(x)}}function Et(e,{margin:t,width:o,height:n,top:i,left:r,bottom:l,right:s}){const f=n+t.bottom+t.top;e.fillStyle=S.margin,e.fillRect(r,i-t.top,o,t.top),e.fillRect(s,i-t.top,t.right,f),e.fillRect(r,l,o,t.bottom),e.fillRect(r-t.left,i-t.top,t.left,f);const a=[{type:"margin",text:b(t.top),position:"top"},{type:"margin",text:b(t.right),position:"right"},{type:"margin",text:b(t.bottom),position:"bottom"},{type:"margin",text:b(t.left),position:"left"}];return k(a)}function vt(e,{padding:t,border:o,width:n,height:i,top:r,left:l,bottom:s,right:f}){const a=n-o.left-o.right,h=i-t.top-t.bottom-o.top-o.bottom;e.fillStyle=S.padding,e.fillRect(l+o.left,r+o.top,a,t.top),e.fillRect(f-t.right-o.right,r+t.top+o.top,t.right,h),e.fillRect(l+o.left,s-t.bottom-o.bottom,a,t.bottom),e.fillRect(l+o.left,r+t.top+o.top,t.left,h);const m=[{type:"padding",text:t.top,position:"top"},{type:"padding",text:t.right,position:"right"},{type:"padding",text:t.bottom,position:"bottom"},{type:"padding",text:t.left,position:"left"}];return k(m)}function Ot(e,{border:t,width:o,height:n,top:i,left:r,bottom:l,right:s}){const f=n-t.top-t.bottom;e.fillStyle=S.border,e.fillRect(r,i,o,t.top),e.fillRect(r,l-t.bottom,o,t.bottom),e.fillRect(r,i+t.top,t.left,f),e.fillRect(s-t.right,i+t.top,t.right,f);const a=[{type:"border",text:t.top,position:"top"},{type:"border",text:t.right,position:"right"},{type:"border",text:t.bottom,position:"bottom"},{type:"border",text:t.left,position:"left"}];return k(a)}function St(e,{padding:t,border:o,width:n,height:i,top:r,left:l}){const s=n-o.left-o.right-t.left-t.right,f=i-t.top-t.bottom-o.top-o.bottom;return e.fillStyle=S.content,e.fillRect(l+o.left+t.left,r+o.top+t.top,s,f),[{type:"content",position:"center",text:`${b(s)} x ${b(f)}`}]}function Tt(e,t){return o=>{if(e&&o){const n=bt(e,t),i=Et(o,n),r=vt(o,n),l=Ot(o,n),s=St(o,n),f=n.width<=P*3||n.height<=P;wt(o,n,[...s,...r,...l,...i],f)}}}function jt(e,t){st(Tt(e,t))}const Bt=(e,t)=>{const o=document.elementFromPoint(e,t),n=r=>{if(r&&r.shadowRoot){const l=r.shadowRoot.elementFromPoint(e,t);return r.isEqualNode(l)?r:l!=null&&l.shadowRoot?n(l):l}return r};return n(o)||o};function Ct(e,t,o){const n=Bt(e,t);n&&jt(n,o)}function Mt({storyPreviewId:e}){const[t,o]=u.useState(!1),n=Q(),i=t?"Turn off measure":"Turn on measure",r=u.useCallback(()=>{o(l=>!l)},[]);return u.useEffect(W,[n]),u.useEffect(()=>{const l=f=>{window.requestAnimationFrame(()=>{f.stopPropagation(),Ct(f.clientX,f.clientY,e)})},s=()=>window.requestAnimationFrame(()=>{ft(e)});if(t){const f=document.getElementById(e);if(!f)return;f.addEventListener("mouseover",l),lt(e),window.addEventListener("resize",s)}return()=>{window.removeEventListener("resize",s),at()}},[t,e]),u.createElement(G,{message:i},u.createElement(J.Button,{asChild:!0},u.createElement(K,{onClick:r},t?u.createElement(it,null):u.createElement(et,null))))}export{Mt as default};
